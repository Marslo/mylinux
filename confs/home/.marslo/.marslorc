#!/bin/bash
# shellcheck disable=SC2034,SC1090
# =============================================================================
#   FileName : .marslorc
#     Author : marslo.jiao@gmail.com
#    Created : 2012
# LastChange : 2020-10-20 21:50:33
# =============================================================================

export iRCHOME='/Users/marslo/.marslo'

bashComp="$(brew --prefix)/etc/bash_completion.d"
bashComp2="$(brew --prefix)/etc/profile.d/bash_completion.sh"
rtComp="/Users/marslo/.jfrog/jfrog_bash_completion"
gitComp="$(brew --prefix)/etc/bash_completion.d/git-prompt.sh"
maccliComp='/usr/local/bin/mac-cli/completion/bash_completion'
dockerComp="$(brew --prefix)/etc/bash_completion.d/docker"
dockerComposeComp="$(brew --prefix)/etc/bash_completion.d/docker-compose"
groovyHome='/opt/groovy-3.0.7'
# groovyHome="$(brew --prefix groovy)"
# bashComp2=$(pkg-config --variable=completionsdir bash-completion)

if command -v brew > /dev/null; then
  # bash-completion
  [ -f "${bashComp}" ] && export BASH_COMPLETION_COMPAT_DIR="${bashComp}" && source "${bashComp}"
  # bash-completion@2
  [ -f "${bashComp2}" ] && source "${bashComp2}";
  [ -f "${rtComp}" ] && source "${rtComp}"
  [ -f "${gitComp}" ] && source "${gitComp}"
  [ -f "${maccliComp}" ] && source "${maccliComp}"
  [ -f "${dockerComp}" ] && source "${dockerComp}"
  [ -f "${dockerComposeComp}" ] && source "${dockerComposeComp}"
  [ -d "${groovyHome}/bin"  ] && source <(cat "${groovyHome}"/bin/*_completion)
  # find "${groovyHome}/bin" -name '*_completion' -print0 | xargs -0 -I FILE bash -c "source FILE"
fi

source "${iRCHOME}/others/bash_completion.sh"
source <(cat "${iRCHOME}/.imac" \
             "${iRCHOME}/.env" \
             "${iRCHOME}/.gitrc"
        )
# eval "$(rbenv init -)"

# source $HOME/.tmux-session
shopt -s cdspell
shopt -s cmdhist
shopt -s histappend
# shopt -s extdebug

# Disable ctrl+s lock putty
# stty -echo
# stty stop undef
stty ixany
stty ixoff -ixon
# stty start undef

export TERM='xterm-color'
# CentOS or RHEL
[ -e /usr/share/terminfo/x/xterm-256color ] && export TERM='xterm-256color'
# Ubuntu
[ -e /lib/terminfo/x/xterm-256color ] && export TERM='xterm-256color'
# cygwin
[ -e /usr/share/terminfo/78/xterm-256color ] && export TERM='xterm-256color'
# MacOS
[ -e /usr/share/terminfo/78/xterm-256color ] && export TERM='xterm-256color'

# iTerm2 shell integration
test -e "${HOME}/.iterm2_shell_integration.bash" && source "${HOME}/.iterm2_shell_integration.bash"

[ -f /usr/local/bin/screenfetch ] && /usr/local/bin/screenfetch

# for linux
# LS="/bin/ls"
# GREP="/bin/grep"
# for MacOS
if test -f "/usr/local/opt/coreutils/libexec/gnubin/ls"; then
  LS="/usr/local/opt/coreutils/libexec/gnubin/ls"
elif test -f "/usr/bin/ls"; then
  LS="/usr/bin/ls"
else
  LS="$(\which -a ls | head)"
fi

if test -f "/usr/local/opt/grep/libexec/gnubin/grep"; then
  GREP="/usr/local/opt/grep/libexec/gnubin/grep"
elif test -f "/usr/bin/grep"; then
  GREP="/usr/bin/grep"
elif test -f "/bin/grep"; then
  GREP="/bin/grep"
else
  GREP="$(\which -a grep | head)"
fi

# For public server (use common account)
function bello()
{
  # For Public account server
  source "${iRCHOME}/.imac"
  # set -o vi
}

function bye()
{
  # For Public account server
  source "${iRCHOME}/.bye_marslo"
  # set -o vi
}

# ┌───────┬─────────┬──────────────────┐   ┌──────┬─────────────────┬──────────┐
# │ Fg/Bg │ Style   │ Octal            │   │ Code │ Style           │ Octal    │
# ├───────┼─────────┼──────────────────┤   ├──────┼─────────────────┼──────────┤
# │  K/k  │ Black   │ \033[ + 3/4 + 0m │   │   s  │ Bold (strong)   │ \033[1m  │
# │  R/r  │ Red     │ \033[ + 3/4 + 1m │   │   u  │ Underline       │ \033[4m  │
# │  G/g  │ Green   │ \033[ + 3/4 + 2m │   │   f  │ Blink (flash)   │ \033[5m  │
# │  Y/y  │ Yellow  │ \033[ + 3/4 + 3m │   │   n  │ Negative        │ \033[7m  │
# │  B/b  │ Blue    │ \033[ + 3/4 + 4m │   ├──────┼─────────────────┼──────────┤
# │  M/m  │ Magenta │ \033[ + 3/4 + 5m │   │   S  │ Normal (unbold) │ \033[22m │
# │  C/c  │ Cyan    │ \033[ + 3/4 + 6m │   │   0  │ Reset           │ \033[0m  │
# │  W/w  │ White   │ \033[ + 3/4 + 7m │   └──────┴─────────────────┴──────────┘
# └───────┴─────────┴──────────────────┘
#
# References:
#  - [WAOW! Complete explanations](https://stackoverflow.com/a/28938235/101831)
#  - [coloring functions](https://gist.github.com/inexorabletash/9122583)
# credit belongs to https://raw.githubusercontent.com/ppo/bash-colors/master/bash-colors.sh
c() {
  # shellcheck disable=SC1009,SC2015
  [ $# -eq 0 ] && echo "\033[0m" || echo "$1" | sed -E "s/(.)/‹\1›/g;s/([KRGYBMCW])/3\1/g;s/([krgybmcw])/4\1/g;s/S/22/;y/sufnKRGYBMCWkrgybmcw›/14570123456701234567m/;s/‹/\\\033[/g";
}

# my functions
source <( cat "${iRCHOME}/bin/ifunc.sh" \
              "${iRCHOME}/bin/ii.sh" \
              "${iRCHOME}/bin/ig.sh" \
              "${iRCHOME}/bin/irt.sh" \
              "${iRCHOME}/bin/im.sh"
        )
# source "${iRCHOME}/bin/idisable"
